; ============================================================================
; Configuração do Xdebug 3+ para PHP 8.x
; ============================================================================
; Adicione estas configurações ao final do seu arquivo php.ini
; Localização comum: php.ini, conf.d/99-xdebug.ini ou php.d/xdebug.ini
;
; Após modificar, reinicie o servidor web (Apache/Nginx/PHP-FPM)
; Verificar instalação: php -v ou php -m | grep xdebug
; ============================================================================

[xdebug]
; ----------------------------------------------------------------------------
; EXTENSÃO - Carregar o Xdebug
; ----------------------------------------------------------------------------
; Windows: zend_extension=xdebug
; Linux/Mac: zend_extension=xdebug.so
; Caminho completo se necessário: zend_extension=/caminho/para/xdebug.so
zend_extension=xdebug

; ----------------------------------------------------------------------------
; MODO DE OPERAÇÃO
; ----------------------------------------------------------------------------
; Valores possíveis (separados por vírgula):
;   - off       : desabilita todas as funcionalidades
;   - develop   : helpers de desenvolvimento (melhor var_dump, stack traces)
;   - debug     : step debugging (VS Code, PhpStorm, etc)
;   - coverage  : cobertura de código para testes
;   - gcstats   : coleta de estatísticas de garbage collection
;   - profile   : profiling de performance
;   - trace     : trace de execução de funções
;
xdebug.mode=debug,develop

; ----------------------------------------------------------------------------
; INICIALIZAÇÃO DO DEBUG
; ----------------------------------------------------------------------------
; Controla quando o Xdebug inicia uma sessão de debug
;   - yes     : sempre inicia automaticamente
;   - no      : nunca inicia automaticamente
;   - trigger : apenas quando receber um trigger (recomendado)
;
xdebug.start_with_request=trigger

; Valor específico do trigger para maior segurança (opcional)
; Se definido, apenas requisições com este valor irão iniciar debug
; Deixe comentado para aceitar qualquer valor de trigger
;xdebug.trigger_value=minha_chave_secreta

; ----------------------------------------------------------------------------
; CLIENTE DE DEBUG (IDE)
; ----------------------------------------------------------------------------
; Porta para comunicação com a IDE
; Xdebug 3 usa 9003 por padrão (Xdebug 2 usava 9000)
xdebug.client_port=9003

; Host onde a IDE está escutando (geralmente localhost)
xdebug.client_host=127.0.0.1

; Timeout de conexão com a IDE (em milissegundos)
xdebug.connect_timeout_ms=200

; Nome do IDE key (útil para ambientes multi-usuário)
;xdebug.idekey=VSCODE

; ----------------------------------------------------------------------------
; DESCOBERTA AUTOMÁTICA DE CLIENTE
; ----------------------------------------------------------------------------
; Tenta descobrir automaticamente o IP do cliente
; Útil em ambientes Docker/containers
;xdebug.discover_client_host=true

; IP do cliente quando discover_client_host está ativo
;xdebug.client_discovery_header=HTTP_X_FORWARDED_FOR

; ----------------------------------------------------------------------------
; LOGGING E DIAGNÓSTICO
; ----------------------------------------------------------------------------
; Arquivo de log para diagnóstico de problemas
; Muito útil quando o debug não está conectando
; Windows: xdebug.log=C:\laragon\www\xdebug.log
; Linux: xdebug.log=/var/log/xdebug.log
xdebug.log=xdebug.log

; Nível de log
; 0=crítico, 1=erro, 3=avisos, 5=comunicação, 7=debug, 10=tudo
xdebug.log_level=7

; ----------------------------------------------------------------------------
; EXIBIÇÃO DE VARIÁVEIS (modo develop)
; ----------------------------------------------------------------------------
; Profundidade máxima de aninhamento ao exibir arrays/objetos
xdebug.var_display_max_depth=10

; Número máximo de elementos de array/propriedades de objeto
xdebug.var_display_max_children=256

; Tamanho máximo de strings exibidas
xdebug.var_display_max_data=1024

; ----------------------------------------------------------------------------
; STACK TRACES (modo develop)
; ----------------------------------------------------------------------------
; Número máximo de níveis em um stack trace
xdebug.max_nesting_level=256

; Coleta argumentos de função em stack traces
xdebug.collect_params=4

; Formato de exibição de stack traces
; 0=simples, 1=com contexto de arquivo
xdebug.show_error_trace=1

; ----------------------------------------------------------------------------
; PROFILING (quando xdebug.mode inclui 'profile')
; ----------------------------------------------------------------------------
; Diretório para salvar arquivos de profiling
;xdebug.output_dir=/tmp/xdebug

; Nome do arquivo de profiling
;xdebug.profiler_output_name=cachegrind.out.%p

; ----------------------------------------------------------------------------
; TRACE (quando xdebug.mode inclui 'trace')
; ----------------------------------------------------------------------------
; Diretório para salvar arquivos de trace
;xdebug.output_dir=/tmp/xdebug

; Nome do arquivo de trace
;xdebug.trace_output_name=trace.%c

; Formato de trace (0=legível, 1=computável, 2=HTML)
;xdebug.trace_format=0

; ----------------------------------------------------------------------------
; COBERTURA DE CÓDIGO (quando xdebug.mode inclui 'coverage')
; ----------------------------------------------------------------------------
; Nenhuma configuração adicional necessária para cobertura básica
; PHPUnit e outras ferramentas gerenciam isso automaticamente

; ============================================================================
; CONFIGURAÇÕES PARA AMBIENTES ESPECÍFICOS
; ============================================================================

; --- DOCKER / CONTAINERS ---
; Use estas configurações quando o PHP roda em container:
;xdebug.client_host=host.docker.internal
;xdebug.discover_client_host=true

; --- VS CODE ---
; Configuração básica funciona com estas settings
; Instale a extensão: PHP Debug (Felix Becker)
; launch.json deve ter port: 9003

; --- PHPSTORM ---
; Vá em Settings > PHP > Debug
; Configure Xdebug port: 9003
; Habilite "Can accept external connections"

; --- LARAGON (Windows) ---
; Use caminhos Windows:
; xdebug.log=C:\laragon\www\xdebug.log
; zend_extension=xdebug (sem .so)

; ============================================================================
; TRIGGERS - COMO ATIVAR O DEBUG
; ============================================================================
; Quando xdebug.start_with_request=trigger, use um dos métodos:
;
; 1. COOKIE (mais comum):
;    Nome: XDEBUG_SESSION
;    Valor: qualquer (ou xdebug.trigger_value se definido)
;    
; 2. GET/POST:
;    ?XDEBUG_SESSION_START=1
;    
; 3. HEADER HTTP:
;    X-XDEBUG-SESSION: 1
;
; 4. EXTENSÕES DE BROWSER:
;    - Chrome: Xdebug Helper
;    - Firefox: Xdebug Helper
;    - Edge: Xdebug Helper
;
; 5. CLI/TERMINAL:
;    export XDEBUG_SESSION=1
;    php script.php
;
; ============================================================================
; VERIFICAÇÃO
; ============================================================================
; Após configurar, verifique com:
;   php -v                  # Deve mostrar "with Xdebug vX.X.X"
;   php -m | grep xdebug    # Deve listar xdebug
;   php -i | grep xdebug    # Mostra todas as configurações
;
; Ou crie um arquivo PHP:
;   <?php phpinfo(); ?>
; Procure pela seção "xdebug"
;
; ============================================================================

;Configuração “ouro” para dev local (resumo)
;zend_extension = xdebug

;[xdebug]
;xdebug.mode = debug,develop
;xdebug.start_with_request = trigger
;xdebug.client_host = 127.0.0.1
;xdebug.client_port = 9003
;xdebug.log = "C:\laragon\tmp\xdebug.log"
;xdebug.log_level = 7
; ============================================================================